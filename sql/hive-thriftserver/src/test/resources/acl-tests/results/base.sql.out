-- Automatically generated by ThriftEndToEndAclTestSuite
-- Number of queries: 18


-- !query 0
create database db1
-- !query 0 token
super
-- !query 0 schema
struct<Result:string>
-- !query 0 output



-- !query 1
create view db1.vw1 as select * from range(10)
-- !query 1 token
super
-- !query 1 schema
struct<Result:string>
-- !query 1 output



-- !query 2
select * from db1.vw1
-- !query 2 token
super
-- !query 2 schema
struct<id:bigint>
-- !query 2 output
[0]
[1]
[2]
[3]
[4]
[5]
[6]
[7]
[8]
[9]


-- !query 3
select * from db1.vw1
-- !query 3 token
usr1
-- !query 3 schema
struct<>
-- !query 3 output
java.lang.SecurityException: User does not have permission SELECT on table `db1`.`vw1`


-- !query 4
grant select on db1.vw1 to usr1
-- !query 4 token
super
-- !query 4 schema
struct<Result:string>
-- !query 4 output



-- !query 5
grant read_metadata on database db1 to usr1
-- !query 5 token
super
-- !query 5 schema
struct<Result:string>
-- !query 5 output



-- !query 6
show grant usr1 on db1.vw1
-- !query 6 token
usr1
-- !query 6 schema
struct<Principal:string,ActionType:string,ObjectType:string,ObjectKey:string>
-- !query 6 output
[usr1, SELECT, TABLE, `db1`.`vw1`]


-- !query 7
show tables in db1
-- !query 7 token
usr1
-- !query 7 schema
struct<database:string,tableName:string,isTemporary:boolean>
-- !query 7 output
[db1, vw1, false]


-- !query 8
select * from db1.vw1
-- !query 8 token
usr1
-- !query 8 schema
struct<id:bigint>
-- !query 8 output
[0]
[1]
[2]
[3]
[4]
[5]
[6]
[7]
[8]
[9]


-- !query 9
revoke all privileges on db1.vw1 from usr1
-- !query 9 token
super
-- !query 9 schema
struct<Result:string>
-- !query 9 output



-- !query 10
revoke all privileges on database db1 from usr1
-- !query 10 token
super
-- !query 10 schema
struct<Result:string>
-- !query 10 output



-- !query 11
show grant usr1 on db1.vw1
-- !query 11 token
usr1
-- !query 11 schema
struct<Principal:string,ActionType:string,ObjectType:string,ObjectKey:string>
-- !query 11 output



-- !query 12
show tables in db1
-- !query 12 token
usr1
-- !query 12 schema
struct<>
-- !query 12 output
java.lang.SecurityException: User does not have permission READ_METADATA on database `db1`


-- !query 13
select * from db1.vw1
-- !query 13 token
usr1
-- !query 13 schema
struct<>
-- !query 13 output
java.lang.SecurityException: User does not have permission SELECT on table `db1`.`vw1`


-- !query 14
drop view db1.vw1
-- !query 14 token
super
-- !query 14 schema
struct<Result:string>
-- !query 14 output



-- !query 15
drop database db1
-- !query 15 token
super
-- !query 15 schema
struct<Result:string>
-- !query 15 output



-- !query 16
show databases
-- !query 16 token
super
-- !query 16 schema
struct<databaseName:string>
-- !query 16 output
[default]


-- !query 17
msck repair database __all__ privileges
-- !query 17 token
super
-- !query 17 schema
struct<Result:string>
-- !query 17 output

